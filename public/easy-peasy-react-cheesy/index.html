<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Easy Peasy React Cheesy | My New Hugo Site</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Last week on twitter Dan Abramov was highlighting some of the easy ways to get your feet wet with React. I&rsquo;ve been playing with React for a while, and had heard the idea that one could add React as an individual component, or widget, to an already existing site. This looked like a good opportunity to try it out.
Caveat before we begin, the docs are great, there&rsquo;s nothing I&rsquo;m expanding here on what&rsquo;s already covered in the docs.">
    <meta name="generator" content="Hugo 0.91.2" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      

    

    
    
    <meta property="og:title" content="Easy Peasy React Cheesy" />
<meta property="og:description" content="Last week on twitter Dan Abramov was highlighting some of the easy ways to get your feet wet with React. I&rsquo;ve been playing with React for a while, and had heard the idea that one could add React as an individual component, or widget, to an already existing site. This looked like a good opportunity to try it out.
Caveat before we begin, the docs are great, there&rsquo;s nothing I&rsquo;m expanding here on what&rsquo;s already covered in the docs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.org/easy-peasy-react-cheesy/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2018-07-02T08:06:00+00:00" />
<meta property="article:modified_time" content="2018-07-02T08:06:00+00:00" />

<meta itemprop="name" content="Easy Peasy React Cheesy">
<meta itemprop="description" content="Last week on twitter Dan Abramov was highlighting some of the easy ways to get your feet wet with React. I&rsquo;ve been playing with React for a while, and had heard the idea that one could add React as an individual component, or widget, to an already existing site. This looked like a good opportunity to try it out.
Caveat before we begin, the docs are great, there&rsquo;s nothing I&rsquo;m expanding here on what&rsquo;s already covered in the docs."><meta itemprop="datePublished" content="2018-07-02T08:06:00+00:00" />
<meta itemprop="dateModified" content="2018-07-02T08:06:00+00:00" />
<meta itemprop="wordCount" content="1351">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Easy Peasy React Cheesy"/>
<meta name="twitter:description" content="Last week on twitter Dan Abramov was highlighting some of the easy ways to get your feet wet with React. I&rsquo;ve been playing with React for a while, and had heard the idea that one could add React as an individual component, or widget, to an already existing site. This looked like a good opportunity to try it out.
Caveat before we begin, the docs are great, there&rsquo;s nothing I&rsquo;m expanding here on what&rsquo;s already covered in the docs."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        My New Hugo Site
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>
    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">Easy Peasy React Cheesy</h1>
      
      <p class="tracked">
          By <strong>
          
              Clayton Salem
          
          </strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2018-07-02T08:06:00Z">July 2, 2018</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>Last week on twitter <a href="https://twitter.com/dan_abramov/status/1011995700748521477">Dan Abramov</a> was highlighting some of the easy ways to get your feet wet with React. I&rsquo;ve been playing with React for a while, and had heard the idea that one could add React as an individual component, or widget, to an already existing site. This looked like a good opportunity to try it out.</p>
<p>Caveat before we begin, the docs are great, there&rsquo;s nothing I&rsquo;m expanding here on what&rsquo;s already covered in the docs. If you want to learn React, go read <a href="https://reactjs.org/docs/hello-world.html">the docs</a>.</p>
<h2 id="easy-incrementor">Easy Incrementor</h2>
<p><img src="/images/2018/counter1.gif" alt="simple counter"></p>
<p>Oh, hi, you&rsquo;re still here. I&rsquo;m going to start with something close to the <a href="https://reactjs.org/docs/add-react-to-a-website.html">example</a>. Essentially, a small &ldquo;like&rdquo; button. However, I am upping the ante and instead of a simple, &ldquo;You liked it&rdquo;, we&rsquo;ll increment the &ldquo;likes&rdquo; on the button.</p>
<p>The beauty of this process is that we&rsquo;re including React libraries directly by <code>script</code> tag. No preprocessors, no webpack, we can even avoid <code>npm</code>.</p>
<blockquote>
<p>I was trying to decide if I should include my semi-controversial opinion about using CDN&rsquo;s, that is, don&rsquo;t use them, when I loaded the <code>unpkg</code> links in the site and&hellip; they were throwing 502 errors. So, here&rsquo;s my opinion: why trust a third party to always have the resources you need? Serve it yourself.</p>
</blockquote>
<p>But&hellip;. this is a demo project, and avoiding webpack, task runners, watchers&hellip; let do it! Here is a for real-life-already-existing website:</p>
<pre tabindex="0"><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;UTF-8&quot;&gt;
&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;
&lt;title&gt;For Real Website&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;A Real Website&lt;/h1&gt;
&lt;p&gt;With lot's of content, and other cool stuff.&lt;/p&gt;
&lt;div id=&quot;like_button_container&quot;&gt;&lt;/div&gt;
&lt;footer&gt;ouch, I stubbed my footer&lt;/footer&gt;
&lt;!-- Here's React! --&gt;
&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/react/16.4.1/umd/react.development.js&quot; crossorgin&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/react-dom/16.4.1/umd/react-dom.development.js&quot; crossorgin&gt;&lt;/script&gt;
&lt;!-- and here's the code --&gt;
&lt;script src=&quot;./dist/like_button.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>First we&rsquo;re going to try React without JSX. I had some vague notion that JSX and React were different, but I haven&rsquo;t really considered one without the other. It turns out JSX looks a lot like a wrapper for <code>React.createElement</code>. <code>createElement</code> takes three arguments: the element type, the configuration (which in this case it going to be simply the click handler), and the element&rsquo;s children (in this case the button text).</p>
<p>Our LikeButton class.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>In the constructor we&rsquo;ll set the counter to 0.</p>
<pre tabindex="0"><code>constructor(props) {
  super(props);
  this.state = { counter: 0 };
}
</code></pre><p>Next the render, which sets the text for the button, and returns the <code>createElement</code>.</p>
<pre tabindex="0"><code>  render() {
    let buttonText = 'Like'
    if (this.state.counter &gt; 0) {
      buttonText = 'Liked ' + this.state.counter + ' times';
    }
    return React.createElement( // createElement takes 3 arguments
      'button', // the element type
      { onClick: () =&gt; this.setState({ counter: this.state.counter + 1 }) }, // config
      buttonText // children, in this case text, but it could be another element.
    );
  }
</code></pre><p>Finally, we select the widget container and render in our LikeButton</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="uping-the-game">Uping the Game</h2>
<p><img src="/images/2018/counter2.gif" alt="squad goals"></p>
<p>I have some problems with this widget. First, it only goes up, thanks Facebook, and second, it&rsquo;s ephemeral and the values disappear as soon as the page is refreshed. I&rsquo;m going to up the game: add two button, increment and decrement (plus and minus to you plebians), and store the values in a database.</p>
<h3 id="add-jsx">Add JSX</h3>
<p>As simple as the <code>React.createElement</code> appears, once we start nesting elements it&rsquo;s going to get messier. I like JSX for the reason that it nests like HTML or XML. In the docs we&rsquo;re told, though not recommended, that we can add JSX support from the CDN&hellip; I guess that means it will compile the JSX on-the-fly. That seems a little nuts, so we&rsquo;re going to add a little compiler on the development side. You might compare this to compiling Sass. This part is covered in the docs, though my config ended up a bit different.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>then <code>npx</code> will watch the source directory and output to the dist directory.</p>
<pre tabindex="0"><code>npx babel --watch src --out-dir dist --presets react
</code></pre><p>Update the render, we&rsquo;re wrapping a div around two buttons and some text. If you run the following code through the <a href="https://babeljs.io/repl/#?babili=false&amp;browsers=&amp;build=&amp;builtIns=false&amp;spec=false&amp;loose=false&amp;code_lz=MYGwhgzhAEDCD2BXAdgFwKYCdroB4eQBMYAldMYVAOgQFsAHeZdNaAbwChppMXCsAFAEp2XbtBDpU0YElYBeaKgAWASwhUIqMBiqyUqANwcx3XqkSZk0AafEAeQqoBuAPjvjo9gEaJUqJmgmWBBVYABreTYBdBF5VyU1DWUwIkkQsPCBAEYhAF9XAGp7AHpffyZ3T082fTQ8jwdygOtg0IiomLiElXUqFLT0DIiBAQBaXPzXMYBIUubKxtKnNzshY24GvKA&amp;debug=false&amp;forceAllTransforms=false&amp;shippedProposals=false&amp;circleciRepo=&amp;evaluate=false&amp;fileSize=false&amp;sourceType=module&amp;lineWrap=true&amp;presets=react&amp;prettier=false&amp;targets=&amp;version=6.26.0&amp;envVersion=">online babel compiler</a> you can start to see the connection between JSX and <code>React.createElement</code>.</p>
<pre tabindex="0"><code>render() {
    let count = this.state.count;

    return (
      &lt;div&gt;
        &lt;button onClick={(e) =&gt; this.handleClick(1)}&gt;+&lt;/button&gt;
        {count}
        &lt;button onClick={(e) =&gt; this.handleClick((-1))}&gt;-&lt;/button&gt;
      &lt;/div&gt;
    );
  }
</code></pre><p>And in order to handle the click and update the state:</p>
<pre tabindex="0"><code>handleClick(num) {
    let newCount = this.state.count != null ? this.state.count + num : 1;
    this.setState( { count: newCount } )
  }
</code></pre><p>I&rsquo;m working backward here, just to be confusing.</p>
<h3 id="firebase-it-up">Firebase it up!</h3>
<p>At this point I have a two button counter that works in one session on one page. Let&rsquo;s up the game with a firebase backend. To keep it simple I&rsquo;m setting the thing to open read-write, and basically it has one field, <code>count</code>. And to connect to said database I&rsquo;m using <code>fetch</code>. <a href="https://console.firebase.google.com/?pli=1">Firebase</a> is great, I&rsquo;m not going to explore it here, let&rsquo;s just look at it like a dummy endpoint.</p>
<p>My first try, I put it in</p>
<pre tabindex="0"><code>componentDidMount() {
    fetch('https://myfirebasebackend')
      .then(res =&gt; res.json())
      .then(data =&gt; this.setState({ count: data }));
}
</code></pre><p>More about <a href="https://reactjs.org/docs/react-component.html#the-component-lifecycle">componentDidMount</a> and the lifecycle methods.</p>
<p>In the render I want to check if the count is set yet, if not, on first load, I&rsquo;m putting in a placeholder.</p>
<pre tabindex="0"><code>let count = this.state.count != null ? &lt;span&gt;{this.state.count}&lt;/span&gt; : &lt;span&gt;_&lt;/span&gt;;
</code></pre><p>Next, update the click handler to update the database with a new value.</p>
<pre tabindex="0"><code>handleClick(num) {
    let newCount = this.state.count != null ? parseInt(this.state.count) + num : 1;
    this.setState( { count: newCount } )
    fetch('https://myfirebasebackend', {method: 'PUT', body: JSON.stringify(newCount)})
  }
</code></pre><p>And, yes, I&rsquo;m doing two things at once in a function. How non-functional of me! Seriously, though, this <em>feels</em> wrong, if you know a better, or more functional way to do this, let me know.</p>
<p>We&rsquo;re close, but the value from one browser won&rsquo;t update in another browser, we need to get data from the database in real time. In this case, every second I&rsquo;ll fetch data. First move the fetch <code>GET</code> into a function:</p>
<pre tabindex="0"><code>tick() {
    fetch(COUNTERAPI)
    .then(res =&gt; res.json())
    .then(data =&gt; this.setState({ count: data }));
  }
</code></pre><p>Then call the tick through <code>setInterval</code> from within <code>componentDidMount</code>, and clear it in <code>componentWillUnmount</code>:</p>
<pre tabindex="0"><code>componentDidMount() {
    this.timerID = setInterval(() =&gt; this.tick(), 1000);
  }

  componentWillUnmount() {
    clearInterval(this.timerID);
  }
</code></pre><p>And&hellip; I think that&rsquo;s about it. I may have missed a couple things, so here&rsquo;s the whole shebang:</p>
<pre tabindex="0"><code>'use strict';

const COUNTERAPI = 'https://myfirebasebackend'
class Counter extends React.Component {
  constructor(props) {
    super(props);

    this.state = {};
    this.handleClick = this.handleClick.bind(this);
  }

  componentDidMount() {
    this.timerID = setInterval(() =&gt; this.tick(), 1000);
  }

  componentWillUnmount() {
    clearInterval(this.timerID);
  }

  tick() {
    fetch(COUNTERAPI).then(res =&gt; res.json()).then(data =&gt; this.setState({ count: data }));
  }

  handleClick(num) {
    let newCount = this.state.count != null ? parseInt(this.state.count) + num : 1;
    this.setState( { count: newCount } )
    fetch(COUNTERAPI, {method: 'PUT', body: JSON.stringify(newCount)})
  }

  render() {
    let count = this.state.count != null ? {this.state.count} : '_';

    return (
      &lt;div&gt;
        &lt;button onClick={(e) =&gt; this.handleClick(1)}&gt;+&lt;/button&gt;
        {count}
        &lt;button onClick={(e) =&gt; this.handleClick((-1))}&gt;-&lt;/button&gt;
      &lt;/div&gt;
    );
  }
}

let domContainer = document.querySelector('#like_button_container');
ReactDOM.render(&lt;Counter /&gt;, domContainer);
</code></pre><p>Thanks, dear reader, if you got this far. The question I set out to answer was, is it easy to add React to an existing site? I think the answer is, yes, it is. But if you want to do anything more complicated than a simple counter, you&rsquo;ll probably want to add JSX, and the compiler. While it&rsquo;s nice that I can compile JSX with relative ease. I think the actual use-case for this in production is pretty limited. After all, I think most JavaScript developers could implement a simple counter without the excess weight of the React libraries. Maybe if I wanted to add a very complicated widget to an existing site, or a situation where I want to slowly transition a site from server-render to client site render.</p>
<p>And this leaves un-expolored the actual challenging part of a real website, which will have some Javascript functionality already in place, probably jQuery. Keeping those the jQuery seperate from React would be a whole other interesting challenge.</p>
<p>What this process <em>is</em> great for is learning. Getting up and running in react in just a few minutes is a real pleasure. And it was fun to write some &ldquo;plain React&rdquo; without JSX.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://example.org/" >
    &copy;  My New Hugo Site 2021 
  </a>
    <div>
<div class="ananke-socials">
  
</div></div>
  </div>
</footer>

  </body>
</html>
