<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Slide &#39;n Scroll fun | My New Hugo Site</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="I was tasked with creating a scroll animation, something that I’ve done before, but in a very ad-hoc fashion. I think the first time I did a “parallax” style scroll I did something like this:
That worked fine on an overpowered PC and when it was moving a tiny image up and off the page, but the next task was to move an image across the page in response to scrolling, and I wanted to make sure it was performant on all devices.">
    <meta name="generator" content="Hugo 0.91.2" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      

    

    
    
    <meta property="og:title" content="Slide &#39;n Scroll fun" />
<meta property="og:description" content="I was tasked with creating a scroll animation, something that I’ve done before, but in a very ad-hoc fashion. I think the first time I did a “parallax” style scroll I did something like this:
That worked fine on an overpowered PC and when it was moving a tiny image up and off the page, but the next task was to move an image across the page in response to scrolling, and I wanted to make sure it was performant on all devices." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.org/slide-n-scroll-fun/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2017-03-08T19:06:00+00:00" />
<meta property="article:modified_time" content="2017-03-08T19:06:00+00:00" />

<meta itemprop="name" content="Slide &#39;n Scroll fun">
<meta itemprop="description" content="I was tasked with creating a scroll animation, something that I’ve done before, but in a very ad-hoc fashion. I think the first time I did a “parallax” style scroll I did something like this:
That worked fine on an overpowered PC and when it was moving a tiny image up and off the page, but the next task was to move an image across the page in response to scrolling, and I wanted to make sure it was performant on all devices."><meta itemprop="datePublished" content="2017-03-08T19:06:00+00:00" />
<meta itemprop="dateModified" content="2017-03-08T19:06:00+00:00" />
<meta itemprop="wordCount" content="752">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Slide &#39;n Scroll fun"/>
<meta name="twitter:description" content="I was tasked with creating a scroll animation, something that I’ve done before, but in a very ad-hoc fashion. I think the first time I did a “parallax” style scroll I did something like this:
That worked fine on an overpowered PC and when it was moving a tiny image up and off the page, but the next task was to move an image across the page in response to scrolling, and I wanted to make sure it was performant on all devices."/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        My New Hugo Site
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>
    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">Slide &#39;n Scroll fun</h1>
      
      <p class="tracked">
          By <strong>
          
              Clayton Salem
          
          </strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2017-03-08T19:06:00Z">March 8, 2017</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>I was tasked with creating a scroll animation, something that I’ve done before, but in a very ad-hoc fashion. I think the first time I did a “parallax” style scroll I did something like this:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>That worked fine on an overpowered PC and when it was moving a tiny image up and off the page, but the next task was to move an image across the page in response to scrolling, and I wanted to make sure it was performant on all devices.</p>
<p>The first step was to avoid using `top` or `left` to define the image position. Paul Irish and Paul Lewis have a canonical<a href="https://www.html5rocks.com/en/tutorials/speed/high-performance-animations/"> post</a> on this. The quick take away is the least “expensive” properties to animate are transform, scale, rotate and opacity. For this example we’ll use opacity.</p>
<p>The entire premise of this post is that I’m making performant animations. There is a legitimate question whether this level of detail was premature optimization. However, I had some time and wanted to make the most butter-smooth animations I could.</p>
<p>The second issue was to use the broadly supported <a href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">requestAnimationFrame</a>(rAF). This allows us to make an animation change(frame), only when the computer will actually change pixels on the screen. Otherwise you could end up with repaints occurring whenever and a resulting jumpy animation.</p>
<p>Finally, I incorporated Paul Lewis’s debounce on the rAF <a href="https://www.html5rocks.com/en/tutorials/speed/animations/">post</a>. Basically this is using the rAF to separate the scroll event from the animation update, and prevent the browser from stacking up rAF calls.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Above is the basic skeleton that I took from Paul Lewis. One thing he does that I didn’t get around to is he separates reflows from adding classes. If the animation shows signs of jitters or performance slow-downs in the real-world this is something I might re-address.</p>
<h2 id="scroll-end">Scroll End</h2>
<p>Part of the animation requested was to add a “jiggle” or “wobble” to the image when scrolling stopped. It turns out there is no “scrollEnd” event, so we have to find it ourselves. My solution involved the High Resolution Timestamp.</p>
<p>First I added a timeCheck variable outside the update function. Then I set the timeCheck variable to equal the timestamp at the bottom of the update function.</p>
<!-- raw HTML omitted -->
<p>This way on my second(or third or fourth..) time through update(), we can compare the difference between the time the animation starts, and the last time through. This should give us a pretty accurate idea if we’ve stopped scrolling or not</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Why 17? Well, this is optimized for screens that are painting at 60fps(frames per second). Since 1 / 60 = 16.7 that’s the lowest possible time between two frames. It would be interesting to see if a slower screen, say 30fps, would trigger the added class even while continuing to scroll.</p>
<h2 id="some-math">Some Math</h2>
<p>Finally, I wanted to define the movement of the image based on both scrolling, width of the image, and height of the screen. For a while I struggled to figure out the math, and through sheer will I came up with an algorithm that worked. But then the designer looked at it and decided he wanted the movement to start and stop a little differently.</p>
<p>Stumped, I took a walk. I knew there was some easy way to solve for a two variable problem… Somewhere on the walk I realized that was I was doing was defining a line.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->This took many hours<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>Once I’d figure that out, I could dig deep in my memories of Highschool and drudge up the old</p>
<!-- raw HTML omitted -->
<p>from Algebra. For those of you rusty m is the slope of the line (rise over run) and b is where the line intersects the y axis. From there I just had to define where the image was at page bottom, and where it was at page top, then draw a line between two corners and figure out the slope. (If you look closely you can see my line in the illustration is significantly off, ie. it doesn’t intersect the correct parts of the image rectangle.)</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>This looks a little ugly because there’s some maths to get the position of the bottom corner of the image. But it’s essentially just filling in the values for m and b and solving for x.</p>
<p>Here’s some math figuring out the Right to Left version. And trust me there were pages and pages more of this crap, this is the cleaned up version.<!-- raw HTML omitted --></p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->That pencil is so naturally placed<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>Here’s the full code. I’m not sure how much use it is since there are specific problems I’ve solved here.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://example.org/" >
    &copy;  My New Hugo Site 2021 
  </a>
    <div>
<div class="ananke-socials">
  
</div></div>
  </div>
</footer>

  </body>
</html>
